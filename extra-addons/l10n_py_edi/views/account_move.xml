<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_move_form_inherit_account" model="ir.ui.view">
        <field name="name">account.move.form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@id='header_right_group']/div[1]" position="replace">
                <div class="o_td_label"
                     invisible="move_type not in ['out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'] ">
                    <label for="invoice_payment_term_id" string="Payment terms"/>
                </div>
            </xpath>

            <xpath expr="//group[@id='header_right_group']/div[2]" position="replace">
                <div class="d-flex"
                     invisible="move_type not in ['out_invoice', 'out_refund', 'in_invoice', 'in_refund', 'out_receipt', 'in_receipt'] ">
                    <field name="invoice_payment_term_id" context="{'example_date': invoice_date, 'example_amount': tax_totals['amount_total']}"
                           placeholder="Terms"/>
                </div>

            </xpath>
            <xpath expr="//notebook" position="inside">
                <page name="reversion_data_page" string="Reversion Data" invisible="move_type not in ['in_refund','out_refund']">
                    <group colspan="2">
                        <group>
                            <field name="reversed_entry_id"/>
                            <field name="reversal_move_ids">
                                <list>
                                    <field name="name"/>
                                    <field name="invoice_date"/>
                                    <field name="amount_total"/>
                                </list>
                            </field>
                        </group>
                        <group></group>
                    </group>
                </page>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']/list/field[@name='price_unit']" position="after">
                <field name="price_unit_with_discount" optional="hide"/>
                <field name="price_unit_with_tax" optional="hide"/>
                <field name="price_subtotal_with_tax" optional="hide"/>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']/list/field[@name='discount']" position="after">
                <field name="unit_discount_amount" optional="hide"/>
                <field name="discount_amount" digits="[15,5]" optional="hide"/>
            </xpath>
            <xpath expr="//field[@name='invoice_line_ids']/list/field[@name='price_subtotal']" position="after">
                <field name="taxable_subtotal" optional="hide"/>
                <field name="tax_total" optional="hide"/>
            </xpath>
            <xpath expr="//field[@name='amount_residual']" position="after">
                <field name="discount_total"/>
            </xpath>
            <xpath expr="//field[@name='narration']" position="after">
                <field name="comment"/>
            </xpath>
        </field>
    </record>

    <record id="edi_account_move_list" model="ir.ui.view">
        <field name="name">account.move.list</field>
        <field name="model">account.move</field>
        <field name="type">list</field>
        <field name="arch" type="xml">
            <list string="Electronic Documents" sample="1">
                <field name="invoice_date" string="Date"/>
                <field name="name"/>
                <field name="partner_id"/>
                <field name="invoice_date_due" widget="remaining_days" string="Exp."/>
                <field name="move_type" string="Type"/>
                <field name="amount_total"/>
                <field name="currency_id" optional="hide"/>
                <field name="state"
                       decoration-success="state == 'posted' "
                       widget="badge"
                       optional="hide"/>
            </list>
        </field>
    </record>

    <record id="view_move_form" model="ir.ui.view">
        <field name="name">l10n_py.account.move.form</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="l10n_py.view_move_form"/>
        <field name="priority">40</field>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='py_page']//group[@name='group_left']" position="inside">
                <field name="edi_document_datetime" readonly="0" force_save="1"/>
                <field name="transaction_type_id"/>
                <field name="tax_type_id"/>
                <field name="document_serial" readonly="1"/>
                <field name="document_number" readonly="1"/>
            </xpath>
            <xpath expr="//page[@name='py_page']//group[@name='group_right']" position="inside">
                <!--
                <field name="is_local_currency"/>
                -->
                <field name="currency_rate_condition"/>
                <field name="issue_type"/>
                <field name="presence_id"/>

                <field name="security_code" readonly="1" force_save="1"/>
                <field name="control_code" readonly="1" force_save="1"/>
                <field name="control_code_graph" readonly="1" force_save="1"/>
                <field name="qr_image" widget="image" style="width:200px; height:200px"/>
            </xpath>
            <xpath expr="//page[@name='py_page']" position="inside">
                <group name="group_reversion_data" string="Reversion Data"
                       invisible="move_type not in ['out_refund','in_refund']">
                    <group>
                        <field name="issue_reason_id" readonly="state != 'draft' "/>
                        <field name="reversal_reason" readonly="state != 'draft' "/>
                    </group>
                    <field name="reverted_invoice_ids" readonly="state != 'draft' " nolabel="1">
                        <list>
                            <field name="reversion_document_type"/>
                            <field name="reverted_cdc"/>
                            <field name="reverted_invoice_full_number"/>

                            <field name="reverted_invoice_type_id" optional="hide"/>
                            <field name="reverted_stamped_number" optional="hide"/>
                            <field name="reverted_invoice_establishment" optional="hide"/>
                            <field name="reverted_invoice_dispatch_point" optional="hide"/>
                            <field name="reverted_invoice_number" optional="hide"/>
                            <field name="reverted_invoice_date" optional="hide"/>
                        </list>
                        <form>
                            <group>
                                <group>
                                    <field name="reversion_document_type"/>
                                </group>
                                <group invisible=" reversion_document_type != '1' ">
                                    <field name="reverted_cdc" required="reversion_document_type == '1' "/>
                                    <field name="reverted_invoice_full_number"/>
                                </group>
                                <group invisible=" reversion_document_type != '2' ">
                                    <field name="reverted_stamped_number" required="reversion_document_type == '2' "/>
                                    <field name="reverted_invoice_establishment" required="reversion_document_type == '2' "
                                           placeholder="e.g. 001"/>
                                    <field name="reverted_invoice_dispatch_point" required="reversion_document_type == '2' "
                                           placeholder="e.g. 001"/>
                                    <field name="reverted_invoice_number" required="reversion_document_type == '2' " placeholder="e.g. 0000123"/>
                                    <field name="reverted_invoice_full_number"/>
                                    <field name="reverted_invoice_date" required="reversion_document_type == '2' "/>
                                    <field name="reverted_invoice_type_id" required="reversion_document_type == '2' "/>
                                </group>
                            </group>
                        </form>
                    </field>
                </group>
            </xpath>
        </field>
    </record>

    <record id="view_account_invoice_filter" model="ir.ui.view">
        <field name="name">account.move.search</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_account_invoice_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='date']" position="after">
                <field name="control_code"/>
            </xpath>
            <xpath expr="//filter[@name='group_by_sequence_prefix']" position="attributes">
                <attribute name="invisible">0</attribute>
            </xpath>
        </field>
    </record>


</odoo>